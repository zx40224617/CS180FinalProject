<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <title>Project 4</title>
  </head>

  <body class="pageContents">
    <h1>Final Project - Neural Radiance Field</h1>
    <div class="wrapper">
      <h2 class="title">Background of the project:</h2>
      <p class="introduction">
        NeRF, Neurial Radiance Field is a technique that was introduced here at
        Berkeley 4 years ago. The idea is that, given all the extrinsics and
        intrinsics of camera taking picture at differenet places, we can use the
        pictures to reconstruct the novel view of the object from any arbitrary
        camera extrinsics to get a 3D view of a scene.
      </p>
      <h3>Part 1. Fit a Neural Field to a 2D Image</h3>
      <p class="introduction">
        In the lecture we talked about that we can use NeRF to ro represent a 3D
        scene. But before we got into that, we can start with a 2D example that
        is much easier. And since there is nocecpt of radiance in 2D, so we only
        use Neural Field \(F: \{u, v\} \rightarrow \{r, g, b\} \) where u, v are
        the pixel coordinate instead of the original NeRF where \(F: \{x, y, z,
        \theta, \phi \} \rightarrow \{r, g, b\} \). So in this part, we are
        going to create a neural field that can represent a 2D image and fit the
        image by optimizing a Multilayer Perceptron
      </p>

      <h4>Details about the Multilayer Perceptron:</h4>
      <p calss="introduction">
        The architecture of the model over here is fairly easy. I technically
        just follow the graph that is provided in the project spec. After we get
        the Sinusoidal Positional Encoding of the 2D corrdinates, there are 3
        consecutive bloacks of 256 hindden units Linear Layer followed by ReLU
        activation. And then a Linear Layer of 3 hidden units and a Sigmoid
        activation at the end to predict the rgb (3D) at the corresponding pixel
        coordinates. Here are my results:
      </p>
      <p class="imgTitle">Network architecture</p>
      <img src="images/mlp_img.jpg" class="noteImage" />

      <h3>Final Results:</h3>
      <p class="imgTitle">Original Image:</p>
      <img src="images/fox.jpg" class="noteImage" />
      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.01,
        batch_szie = 10000, L = 10
      </p>
      <img src="images/fox PSNR 2000.jpg" class="noteImage" />

      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img src="images/fox reconstruction 10.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img src="images/fox reconstruction 20.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img src="images/fox reconstruction 50.jpg" class="resultImage" />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img src="images/fox reconstruction 100.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img src="images/fox reconstruction 200.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img src="images/fox reconstruction 300.jpg" class="resultImage" />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img src="images/fox reconstruction 500.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img src="images/fox reconstruction 1000.jpg" class="resultImage" />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img src="images/fox reconstruction 2000.jpg" class="resultImage" />
        </div>
      </div>

      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.001,
        batch_szie = 10000, L = 10
      </p>
      <img src="images/fox PSNR 2000 lr = 0.001.jpg" class="noteImage" />

      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img
            src="images/fox reconstruction 10 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img
            src="images/fox reconstruction 20 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img
            src="images/fox reconstruction 50 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img
            src="images/fox reconstruction 100 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img
            src="images/fox reconstruction 200 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img
            src="images/fox reconstruction 300 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img
            src="images/fox reconstruction 500 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img
            src="images/fox reconstruction 1000 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img
            src="images/fox reconstruction 2000 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="introduction">
        As we can see in the predicted graph, with the learning rate 0.001 that
        is a lot smaller than the recommened 0.01, the model is converging a
        liitle slower, but it will eventually get a good result.
      </p>

      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.01,
        batch_szie = 10000, L = 5
      </p>
      <img src="images/Fox PSNR 2000 lr = 0.01 L = 5.jpg" class="noteImage" />

      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img
            src="images/Fox reconstruction 10 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img
            src="images/Fox reconstruction 20 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img
            src="images/Fox reconstruction 50 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img
            src="images/Fox reconstruction 100 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img
            src="images/Fox reconstruction 200 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img
            src="images/Fox reconstruction 300 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img
            src="images/Fox reconstruction 500 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img
            src="images/Fox reconstruction 1000 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img
            src="images/Fox reconstruction 2000 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="introduction">
        As we can see in the predicted graph, with a lower L in the Positional
        Encoding, the PSNR become lower and the images is a lot more blurry at
        the same iteration step than the higher L.
      </p>

      <p class="imgTitle">Original Image:</p>
      <img src="images/Berkeley Dawn.webp" class="noteImage" />
      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.01,
        batch_szie = 10000, L = 10
      </p>
      <img src="images/Berkeley PSNR 2000 lr = 0.01.jpg" class="noteImage" />
      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img
            src="images/Berkeley reconstruction 10 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img
            src="images/Berkeley reconstruction 20 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img
            src="images/Berkeley reconstruction 50 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img
            src="images/Berkeley reconstruction 100 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img
            src="images/Berkeley reconstruction 200 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img
            src="images/Berkeley reconstruction 300 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img
            src="images/Berkeley reconstruction 500 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 1000 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 2000 lr = 0.01.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.001,
        batch_szie = 10000, L = 10
      </p>
      <img src="images/Berkeley PSNR 2000 lr = 0.001.jpg" class="noteImage" />

      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img
            src="images/Berkeley reconstruction 10 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img
            src="images/Berkeley reconstruction 20 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img
            src="images/Berkeley reconstruction 50 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img
            src="images/Berkeley reconstruction 100 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img
            src="images/Berkeley reconstruction 200 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img
            src="images/Berkeley reconstruction 300 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img
            src="images/Berkeley reconstruction 500 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 1000 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 2000 lr = 0.001.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="introduction">
        As we can see, we got similar obeservation as above, when we decrease
        the learning rate here, it also take the model more time to converge,
        but it still goes to good results quickly. Also, we can see that for a
        more complex image like this, it is harder to reach a higher PSNR.
      </p>

      <p class="imgTitle">
        PSNR over 2000 iterations with original architecture, lr = 0.01,
        batch_szie = 10000, L = 5
      </p>
      <img
        src="images/Berkeley PSNR 2000 lr = 0.01 L = 5.jpg"
        class="noteImage"
      />

      <p class="imgTitle">Predicted Image at different iterations:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">10 iterations:</p>
          <img
            src="images/Berkeley reconstruction 10 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">20 iterations:</p>
          <img
            src="images/Berkeley reconstruction 20 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">50 iterations:</p>
          <img
            src="images/Berkeley reconstruction 50 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">100 iterations:</p>
          <img
            src="images/Berkeley reconstruction 100 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">200 iterations:</p>
          <img
            src="images/Berkeley reconstruction 200 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">300 iterations:</p>
          <img
            src="images/Berkeley reconstruction 300 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">500 iterations:</p>
          <img
            src="images/Berkeley reconstruction 500 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">1000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 1000 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">2000 iterations:</p>
          <img
            src="images/Berkeley reconstruction 2000 lr = 0.01 L = 5.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="introduction">
        Over here, we got similar observation as above as well. When we lower L,
        the images will become blurry and the PSNR is lower.
      </p>
      <hr />
      <h3>Part 2: Fit a Neural Radiance Field from Multi-view Images</h3>
      <p class="introduction">
        After we are done with the 2D example, we can now jump in to 3D. In this
        part, we are given the all the images of a lego taken at different
        positions with all the extrinsics and intrinsics of the camera. We need
        to inverse rendering from multi-view calibrated images and reconstruct
        the 3D scene of the lego. But in order to achieve that, we need to first
        go through some steps that will help us to get the datas that we need.
      </p>

      <h3>Part 2 - 1: Create Rays from Cameras</h3>
      <p class="introduction">
        For NeRF, we need to get the location of the camera in the reference of
        the world frame, and also the rays that goes from the corresponding
        camera center through the pixel to the actual point of the object in 3D
        scene. Here are the major ideas when I implemented the functions:
      </p>
      <ul class="questions">
        <li>
          transform(c2w, x_c): This one is fairly easy, since c2w transformation
          will transform the points in camera frame to the world frame, so we
          can just do matrix mutiplication. Note that since we want it to be
          batched, I used np.matmul().
        </li>

        <li>
          pixel_to_camera(K, uv, s): Since are given the function in the spec,
          so what we need to do is just invert the process. So I just use
          np.linalg.inv() to get the inverse of the K, and do matrix
          multiplication to get the coordinate.
        </li>

        <li>
          pixel_to_ray(K, c2w, uv): In this function, I used the first 2
          functions that we defined above. I first use the pixel_to_camera
          function to get the pixel position in camera frame, and use transform
          to get the coresponding positions in the world frame. And then I just
          follow the formula provided in the spec to get r_o and r_d. Note that
          since we are given c2w instead of w2c, the r_o formula is different
          from the spec.
        </li>
      </ul>
      <hr />
      <h3>Part 2 - 2: Sampling</h3>
      <ul class="questions">
        <li>
          Sampling Rays from Images: For this function, I first use
          np.meshgrid() to acquire all the pixel coordinate in an image, and
          flat it to get all the pixels value of the images. And I use
          torch.repeat_interleave() to repeat all the transformation that I need
          for all the coordinates in each images. I also use torch.tile() to get
          the coordinates in all the images (uv). I then call function
          pixel_to_ray with all the transformation matrix and uv (may need to
          flip it) to get r_o, r_d. Note that I return everything separately.
        </li>

        <li>
          Sampling Points along Rays: This part is fairly easy, I just follow
          the spec and do some reshaping to make sure I can broadcast the t
          correctly and return the correct shape that I want.
        </li>
      </ul>
      <hr />
      <h3>Part 2 - 3: Putting the Dataloading All Together</h3>
      <p class="introduction">
        This part is where we actually see whether we implemented the previous
        parts correctly or not. We are given some code to visualize the images,
        camera positions and rays. So we can easily tell whether there is any
        problem with the implementation. The idea is similar to what we did in
        part 1, we write a dataloader that randomly select N numbers of rays and
        pixels in the data we got in previous part, and use the provided code to
        visualize those datas. Note that since I implement the RaysData a little
        differently, so I changes some given code, but everything works fine.
        Here is my results with N = 100:
      </p>
      <p class="imgTitle">
        Visualization of the rays, camera positions, and images (N = 100)
      </p>
      <img src="images/viser.png" class="noteImage" />
      <hr />
      <h3>Part 2 - 4: Neural Radiance Field</h3>
      <p class="introduction">
        This part is really similar to what we did in part 1, but the
        architecture is more complex. Most of the things that we do here is just
        more of what we did in part 1. But there are some small things that we
        need to be careful about. Since the shape of the x (coordinates) and r_d
        will be in differenet shape, so we need to do something about the
        positional encoding of the 2 inputs, I personally have 2 different
        functions for the job. But there are some other ways to implement it as
        well. Also, there maybe some issue with the concatanation because of 2
        inputs has different shapes, I just broadcast it by repeating the r_d.
      </p>
      <p class="imgTitle">Network architecture</p>
      <img src="images/MLP_part2.png" class="noteImage" />
      <hr />

      <h3>Part 2 - 5: Volume Rendering</h3>
      <p class="introduction">
        This part is technically just implementing the formula that is provided
        in the spec. I first use torch.exp() and torch.cumsum() to calculate
        \(T_i\). Note that since we only add until i - 1, I prepend 1 to \(T_i\)
        and get rid of the last item. I then just follow the rest of the formula
        to get the rendered_color using torch.sum(). After everything works, we
        can start training. Since We don't have the true value of sigmas, we
        need to first let the network perdict the sigmas and pixel values, use
        the sigmas and pixels value to do volume rendering, and compare the
        final pixels to the original pixels to get the loss. And that's why the
        spec mentioned that we need to implement this part using torch for
        backpropagation.
      </p>
      <p class="imgTitle">Volume Rendering Formula:</p>
      <img src="images/Formula.png" class="noteImage" />
      <hr />
      <h3>Final Results</h3>
      <p class="introduction">
        After we got everything above, we can now start trainging and sampling,
        here are my results with batch_size = 10K, learning rate = 5e-4,
        coordinares L = 10, rays L = 4:
      </p>

      <p class="imgTitle">Training PSNR (2000 iterations):</p>
      <img
        src="images/training NeRF PSNR 2000 lr = 0.0005.jpg"
        class="noteImage"
      />
      <p class="imgTitle">
        Validation PSNR (2000 iterations sample every 20 iterations):
      </p>
      <img
        src="images/validation NeRF PSNR 2000 lr = 0.0005.jpg"
        class="noteImage"
      />

      <p class="imgTitle">Perdicted Images at iterations 10:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 10 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 20:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 20 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 50:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 50 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 100:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 100 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 200:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 200 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>
      <p class="imgTitle">Predicted Images at iterations 300:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 300 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 500:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 500 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 1000:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 1000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="imgTitle">Predicted Images at iterations 2000:</p>
      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 1:</p>
          <img
            src="images/NeRF reconstruction image 0 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 2:</p>
          <img
            src="images/NeRF reconstruction image 1 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 3:</p>
          <img
            src="images/NeRF reconstruction image 2 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <div class="imageWrapper">
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 4:</p>
          <img
            src="images/NeRF reconstruction image 3 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 5:</p>
          <img
            src="images/NeRF reconstruction image 4 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
        <div class="title-image-wrapper">
          <p class="imagSubTitle">Validation Image 6:</p>
          <img
            src="images/NeRF reconstruction image 5 at 2000 lr = 0.0005.jpg"
            class="resultImage"
          />
        </div>
      </div>

      <p class="introduction">
        And we can now use the given test camera extrinsics to genrate the
        spherical rendering of the lego video, Here are my results
      </p>

      <p class="imgTitle">Spherical rendering of the lego</p>
      <img src="images/lego L = 10.gif" class="noteImage" />
      <hr />
      <h3>Bells & Whistles - Lego video with a different background color</h3>
      <p class="introduction">
        I think this Bells & Whistles is fairly easy but also genrate a good
        looking result. Here is the
        <a
          href="https://www.scratchapixel.com/lessons/3d-basic-rendering/volume-rendering-for-developers/intro-volume-rendering.html"
          >reference website</a
        >
        that I look at to implement this Bells & Whistles. The idea is easy, we
        assume that the volume has a color, and we treat the process of adding
        the color as alpha blending. Where the alpha here is the opacity of the
        rgb value. Note that we only need to change the volume rendering during
        sample time, there is no need to retrain the model, here is my result:
      </p>

      <p class="imgTitle">
        Spherical rendering of the lego with a light purple background:
      </p>
      <img
        src="images/lego_with_purple_background L = 10.gif"
        class="noteImage"
      />

      <hr />
      <h3>Final Reflection - Finale</h3>
      <p class="introduction">
        This project is really fun to implement since I am really interested in
        computer vision about 3D scene. And I think there maybe a lot of fun
        things that I can try to explore myself like D-NeRF and instruct
        NeRf-to-NeRF. At last, thank you so much for whoever is reading this
        message, this is a really good semester to me. Hope you have a nice day
        and a good winter break.
      </p>
    </div>
  </body>
</html>
